var exifTool = new ActiveXObject("DOpusScriptingExtensions.ExifTool")
var stringTools = DOpus.Create().StringTools()
var fsUtil = DOpus.FSUtil
var exifToolIcon = getExifToolIcon()

function OnInit(data) {
  data.name = "ExifTool dialog"
  data.desc = "Shows file metadata using ExifTool"
  data.version = "0.0-dev"
  data.url = "https://github.com/PolarGoose/DirectoryOpus-ExifTool-Dialog"
  data.default_enable = true

  var cmd = data.AddCommand()
  cmd.name = "OpenExifToolDialog"
  cmd.method = "onCommandExecuted"
  cmd.template = "FILE"
  cmd.desc = data.desc
  cmd.label = data.desc
}

function onCommandExecuted(/* ScriptCommandData */ scriptCommandData) {
  try {
    var filePath = getFilePathFromCommandArguments(scriptCommandData)
    showExifToolDialog(filePath)
  } catch (error) {
    var dlg = DOpus.Dlg
    dlg.message = error
    dlg.buttons = "OK"
    dlg.icon = "error"
    dlg.show()
  }
}

function addExifToolDataToListView(/* Control */ listView, tagNameAndValueArray) {
  for (var i = new Enumerator(tagNameAndValueArray); !i.atEnd(); i.moveNext()) {
    tag = i.item()
    addItemToListView(listView, tag.TagName, tag.Value)
  }
  listView.columns.autosize()
}

function addItemToListView(/* Control */ listView, /* string */ tagName, /* string */ value) {
  var i = listView.AddItem(tagName)
  listView.GetItemAt(i).subitems(0) = value

  if(tagName === "") {
    listView.GetItemAt(i).style = "b"
  }
}

function showExifToolDialog(/* string */ filePath) {
  var exifToolData = getExifToolData(filePath)
  var dlg = DOpus.Dlg
  dlg.template = "main"
  dlg.icon = exifToolIcon
  dlg.Create()
  addExifToolDataToListView(dlg.Control("ExifTags"), exifToolData)
  dlg.RunDlg()
}

function /* string */ getFilePathFromCommandArguments(/* ScriptCommandData */ scriptCommandData) {
  if(!scriptCommandData.func.args.got_arg.file) {
    throw "FILE argument is not provided"
  }

  var filePath = scriptCommandData.func.args.file
  if(fsUtil.GetType(filePath) === "dir") {
    throw "Provided file is a directory: " + filePath
  }

  return filePath
}

function getExifToolData(/* Path */ filePath) {
  var tags = JSON.parse(exifTool.GetInfoAsJson(filePath))[0]

  var result = []
  var currentShortenedGroupName = ""
  for (var tagFullName in tags) {
    if (tagFullName === "SourceFile") {
      result.push({ "TagName": tagFullName, "Value": tags[tagFullName] })
      continue
    }

    if(tagFullName === "ExifTool:ExifTool:ExifToolVersion") {
      continue
    }

    var shortenedGroupName = getTagGroupShortened(tagFullName)
    if(shortenedGroupName !== currentShortenedGroupName) {
      result.push({ "TagName": "", "Value": "--- " + shortenedGroupName + " ---" })
      currentShortenedGroupName = shortenedGroupName
    }

    result.push({ "TagName": getTagName(tagFullName), "Value": tags[tagFullName].val })
  }

  return result
}

// Extracts the tag name from the full tag name:
//   QuickTime:Meta:TagName => TagName
function getTagName(/* string */ fullTagName) {
  var idx = fullTagName.lastIndexOf(":")
  return fullTagName.substring(idx + 1)
}

// Extract the tag group:
//   QuickTime:QuickTime:TagName => QuickTime
//   QuickTime:Meta:TagName => QuickTime:Meta
function getTagGroupShortened(/* string */ fullTagName) {
  var parts = fullTagName.split(":")
  parts.pop()
  if (parts[0] === parts[1]) {
    return parts[0]
  }
  return parts.join(":")
}

// The icon is taken from https://exiftool.org/forum/index.php?topic=17049.msg91404#msg91404
// The svg was converted to ".ico" BASE64 using the commands:
//   magick favicon.svg -background transparent -resize 256x256 output.ico
//   base64 -w 0 output.ico
function getExifToolIcon() {
  var iconBase64 = "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"
  return DOpus.LoadImage(stringTools.Decode(iconBase64, 'base64'), '.ico')
}

==SCRIPT RESOURCES
<resources>
  <resource name="main" type="dialog">
    <dialog height="300" lang="english" resize="yes" title="ExifTool Dialog" width="421">
      <control fullrow="yes" height="300" name="ExifTags" nosortheader="yes" resize="wh" type="listview" viewmode="details" width="421" x="0" y="0">
        <columns>
          <item text="Tag name" />
          <item text="Value" />
        </columns>
      </control>
    </dialog>
  </resource>
</resources>


